<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Iūdex BARC</title>
   <link rel="start" href="/" />
  

  <!-- No atom yet:
  <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="feed"/>
  -->

  <link rel="stylesheet" href="./css/syntax.css" type="text/css"/>

  <link rel="stylesheet" href="./css/screen.css" type="text/css"/>
</head>

<body id="">

<div id="site">

  <div id="header">
  <span class="nlink" ><a href="./index.html" title="Iūdex">Iūdex</a> ⇒</span>
  <span class="ptitle">BARC</span>
</div>

<div id="sub">
  <h1 id="basic-archive">Basic Archive</h1>

<p><img src="./img/BARC-LARC-XV-2-c.jpg" alt="LARC LX" /><sup id="fnref:cc"><a href="#fn:cc" rel="footnote">1</a></sup></p>

<p>The Iūdex BARC container format supports efficient block storage of
raw downloaded or post-processed content. The format was inspired by
Heritrix <a href="http://crawler.archive.org/articles/developer_manual/arcs.html">ARC</a> and <a href="http://www.digitalpreservation.gov/formats/fdd/fdd000236.shtml">WARC</a>, but offers several unique
features/advantages:</p>

<ul>
  <li>Concurrent and random-access reads by byte offset (external index).</li>
  <li>Single-writer sessions safe with concurrent reads.</li>
  <li>Per-record GZip compression (headers + body payload).</li>
  <li>Efficient random access channel IO.</li>
  <li>Minimal dependencies for read/write access.</li>
</ul>

<ul id="markdown-toc">
  <li><a href="#basic-archive">Basic Archive</a>    <ul>
      <li><a href="#barc-format">BARC Format</a>        <ul>
          <li><a href="#types">Types</a></li>
          <li><a href="#compression-mode">Compression mode</a></li>
        </ul>
      </li>
      <li><a href="#iudex-barc-utility">iudex-barc utility</a></li>
      <li><a href="#human-readable-tofrom-barc">Human-readable to/from BARC</a></li>
      <li><a href="#other-records">Other records</a></li>
    </ul>
  </li>
</ul>

<h2 id="barc-format">BARC Format</h2>

<p>A Human/machine readable header used for first record (offset zero)
and each subsequent record:</p>

<p>Liquid error: No such file or directory - posix_spawnp</p>

<p>All lengths are in hexadecimal bytes, zero-padded and fixed width. The
header itself is 36 bytes long</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Component</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">rlength</td>
      <td>Length of record in hexadecimal bytes (not including header).</td>
    </tr>
    <tr>
      <td style="text-align: center">tt</td>
      <td>Type and compresssion bytes (see below).</td>
    </tr>
    <tr>
      <td style="text-align: center">meta</td>
      <td>Length of meta header block in hexadecimal bytes</td>
    </tr>
    <tr>
      <td style="text-align: center">rqst</td>
      <td>Length of request header block in hexadecimal bytes</td>
    </tr>
    <tr>
      <td style="text-align: center">resp</td>
      <td>Length of response header block in hexadecimal bytes</td>
    </tr>
  </tbody>
</table>

<h3 id="types">Types</h3>

<p>The following record types are currently defined:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">R</td>
      <td>Replaced (or never completed) record. Most consumers will want to ignore these records.</td>
    </tr>
    <tr>
      <td style="text-align: center">H</td>
      <td>HTML or other raw (web downloaded) content. For example, downloaded images would be suitable included as H values.</td>
    </tr>
    <tr>
      <td style="text-align: center">D</td>
      <td>A Delete record containing meta headers, but no body.</td>
    </tr>
  </tbody>
</table>

<h3 id="compression-mode">Compression mode</h3>

<p>The following compression modes are currently defined:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Mode</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">C</td>
      <td>Gzip compressed</td>
    </tr>
    <tr>
      <td style="text-align: center">P</td>
      <td>Plain (uncompressed)</td>
    </tr>
  </tbody>
</table>

<h2 id="iudex-barc-utility">iudex-barc utility</h2>

<p>A. Show Record(s)</p>

<pre><code>iudex-barc show barc/000000.barc
iudex-barc show -mqr -o 0xde411 barc/000015.barc
</code></pre>

<ul>
  <li>From BARC file (all or by record offset)</li>
  <li>Decompresses compressed records</li>
</ul>

<p>(stored in db as integer, so use base-10 offset)</p>

<p>B. HTTP fetch</p>

<pre><code>iudex-http-record [-z] [-t] url outfile
</code></pre>

<ul>
  <li>Append or Truncate existing file</li>
  <li>Compress or not</li>
  <li>Display instead of write?</li>
</ul>

<p>C. Copy/Concatenate record to file</p>

<pre><code>iudex-barc [-zt] copy infile outfile
</code></pre>

<ul>
  <li>Compress target or not</li>
</ul>

<p>(last file implicit write)</p>

<h2 id="human-readable-tofrom-barc">Human-readable to/from BARC</h2>

<p>Format:</p>

<pre><code>-BARC1 H
=META=
meta_header_1: value
meta_header_2: value

=RQST=
Request-Line: GET /foo/bar.html

=RESP=
Status-Line: HTTP/1.1 200 OK

=BODY=
&lt;html&gt;
...
</code></pre>

<h2 id="other-records">Other records</h2>

<p>Sample DELETE:</p>

<pre><code>-BARC1 D
=META=
url: http://foobar/framis
uhash: 98ASDz798a782hasfd79jbz
</code></pre>
<div class="footnotes">
  <ol>
    <li id="fn:cc">
      <p>From <a href="http://en.wikipedia.org/wiki/File:BARC-LARC-XV-2.jpeg">Wikipedia: BARC-LARC-XV-2.jpeg</a>
   (public domain)<a href="#fnref:cc" rel="reference">&#8617;</a></p>
    </li>
  </ol>
</div>

</div>


  <div id="footer">
  <address>
    <span class="copyright">
      Copyright &copy; 2008-now
      <a href="http://gravitext.com/">David Kellum</a>
    </span>
    <span class="engine">
      Powered by
      <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
    </span>
  </address>
  </div>
</div>

</body>
</html>
