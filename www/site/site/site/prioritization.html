<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Iūdex Prioritization and Work Queues</title>
   <link rel="start" href="/" />
  

  <!-- No atom yet:
  <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="feed"/>
  -->

  <link rel="stylesheet" href="./css/syntax.css" type="text/css"/>

  <link rel="stylesheet" href="./css/screen.css" type="text/css"/>
</head>

<body id="">

<div id="site">

  <div id="header">
  <span class="nlink" ><a href="./index.html" title="Iūdex">Iūdex</a> ⇒</span>
  <span class="ptitle">Prioritization and Work Queues</span>
</div>

<div id="sub">
  <h2 id="in-memory-visithost-priority-queues">In-memory Visit/Host Priority Queues</h2>

<p>The <a href="index.html">iudex-core</a> module includes a prioritized visit queue and
executor with the following features:</p>

<ul>
  <li>
    <p>Per-host fetch rate limiting for politeness.</p>
  </li>
  <li>
    <p><code>HostQueue</code>s containing visit orders for the same host, to be
processed in priority order.</p>
  </li>
  <li>
    <p>A <code>VisitQueue</code> of ready and sleeping (delay for politeness)
<code>HostQueue</code>s. The ready queue is prioritized by <code>HostQueue</code> topmost
priority. The sleeping queue is ordered by least next visit time.</p>
  </li>
  <li>
    <p>A custom threaded, concurrent <code>VisitManager</code> for processing the
<code>VisitQueue</code> while upholding host politeness constraints.</p>
  </li>
  <li>
    <p>A pluggable <code>WorkPollStrategy</code>.</p>
  </li>
  <li>
    <p>A <code>GenericWorkPollStrategy</code> including support for minimum poll
interval, and minimum remaining ratios of orders and hosts before
new work is polled.</p>
  </li>
  <li>
    <p>The <code>VisitManager</code> supports generations of VisitQueue(s) and visitor
threads, for high concurrency, and avoiding over-commitment to any
single host.</p>
  </li>
</ul>

<h2 id="postgres-backed-persistent-priority-queue">Postgres-backed persistent priority queue</h2>

<p>The <a href="da/index.html">iudex-da</a> modules provides a <code>WorkPoller</code> implementation of
<code>WorkPollStrategy</code> which obtains prioritized visit orders from a
Postgres database. Features:</p>

<ul>
  <li>
    <p>Only visit orders (urls) with <code>NEXT_VISIT_AFTER</code> the current time are
considered.</p>
  </li>
  <li>
    <p>Visit orders are considered in descending <code>PRIORITY</code> order.</p>
  </li>
  <li>
    <p>The priority of the highest orders associated with a each host (by
URL) is discounted by a fixed factor of per-host depth. This biases
the work polled toward greater breadth of hosts and thus concurrency
of execution, given the per-host politeness constraint.</p>
  </li>
  <li>
    <p>SQL 2003 Window Functions are utilized for efficient calculation of
host depth priority adjustments.</p>
  </li>
</ul>


</div>


  <div id="footer">
  <address>
    <span class="copyright">
      Copyright &copy; 2008-now
      <a href="http://gravitext.com/">David Kellum</a>
    </span>
    <span class="engine">
      Powered by
      <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
    </span>
  </address>
  </div>
</div>

</body>
</html>
